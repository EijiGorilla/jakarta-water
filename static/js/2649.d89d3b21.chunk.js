"use strict";(self.webpackChunkjakarta_water=self.webpackChunkjakarta_water||[]).push([[2649,34429],{19208(e,t,r){r.d(t,{A:()=>l});var i=r(6326),s=r(46053),o=(r(81806),r(76460),r(47249),r(87990)),n=r(62547);let l=class extends n.Z{constructor(e){super(e),this.type="wkb",this.primaryFieldName=null}};(0,i.Cg)([(0,s.MZ)({type:["wkb"]})],l.prototype,"type",void 0),(0,i.Cg)([(0,s.MZ)({type:["counter-clockwise"],json:{write:!0}})],l.prototype,"orientation",void 0),(0,i.Cg)([(0,s.MZ)({type:String,json:{name:"field",write:{isRequired:!0}}})],l.prototype,"primaryFieldName",void 0),l=(0,i.Cg)([(0,o.$)("esri.layers.support.ParquetEncodingWkb")],l)},30178(e,t,r){r.d(t,{hG:()=>h,nc:()=>g,sA:()=>y,ye:()=>p});var i=r(89379),s=(r(19276),r(50076)),o=r(45802),n=r(13312),l=r(44135),a=r(36035),u=r(98141),d=r(19208),c=r(67103);const p=new o.J({esriGeometryPoint:"point",esriGeometryPolygon:"polygon",esriGeometryPolyline:"polyline",esriGeometryMultipoint:"multipoint"});function y(e){return p.toJSON(e)}function h(e){return p.fromJSON(e)}async function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.urls.length<1)throw new s.A("parquet:bad-input","At least one url must be specified",e);if(e.geometryType&&e.spatialReference&&e.encoding&&e.fields)return e;const r=await(0,c.DV)(e.urls.getItemAt(0),{getCustomParameters:()=>t.customParameters}),o=(0,c.hD)(r),p=(0,i.A)((0,i.A)({},e),{},{file:r});null==p.fields&&(p.fields=r.fields().map(e=>l.A.fromJSON({name:e.name,alias:e.name,type:e.type}))),null==p.encoding&&(p.encoding=function(e,t){if(null!=e){const t=e.primary_column,r=e.columns[t];return new d.A({primaryFieldName:t,orientation:"counterclockwise"===r.orientation?"counter-clockwise":null})}const r=(0,a.i_)(t.map(e=>e.name));return r.latitudeFieldName&&r.longitudeFieldName?new u.A({latitudeFieldName:r.latitudeFieldName,longitudeFieldName:r.longitudeFieldName}):null}(o,p.fields));const y=(0,c.Hj)(r);if(y)switch(y.mode){case"z":p.displayOptimization={mode:"z"};break;case"xz":{const e=y.multiscale;if(!e)throw new s.A("parquet:bad-format","XZ display optimization requires multiscale geometries");p.displayOptimization={mode:"xz",multiscale:e};break}}if(!p.encoding)return p;switch(p.encoding.type){case"location":null==p.spatialReference&&(p.spatialReference=n.A.WGS84),null==p.geometryType&&(p.geometryType="point");break;case"wkb":{if(!o)return p;const e=o.primary_column,t=o.columns[e];if(p.geometryType||(p.geometryType=function(e){const{geometry_types:t}=e,r=new Set;for(const i of t){const e=m(i);e&&r.add(e)}if(r.size>1)throw new s.A("parquet:unsupported","Parquet mixed geometry types are not supported",{geometryTypes:r});return 1===r.size?r.values().next().value:void 0}(t)),p.spatialReference||(p.spatialReference=function(e){var t;const r=null===(t=e.crs)||void 0===t||null===(t=t.id)||void 0===t?void 0:t.code;return r&&"number"==typeof r?new n.A({wkid:r}):void 0}(t)),p.fields)for(const r of Object.keys(o.columns))p.fields=p.fields.filter(e=>e.name!==r)}}return p}function m(e){switch(e){case"Point":return"point";case"Polygon":case"MultiPolygon":return"polygon";case"LineString":return"polyline";case"MultiPoint":return"multipoint";default:return null}}},34429(e,t,r){r.d(t,{QueueProcessor:()=>d});var i=r(30726),s=r(50346),o=r(59649),n=r(67993),l=r(52394),a=r(75540);class u{constructor(e,t){this.item=e,this.controller=t,this.promise=null}}class d{constructor(e){this._schedule=null,this._deferreds=new n.A,this._controllers=new n.A,this._processingItems=new n.A,this._pausedSignal=(0,a.v)(!1),this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new o.A(e.peeker),this.process=e.process}destroy(){this.clear(),this._schedule=(0,i.xt)(this._schedule)}get updating(){return this.running}get length(){return this._processingItems.size+this._queue.length}get running(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}abort(e){const t=this._controllers.get(e);t&&t.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach(t=>e.push(t)),this._controllers.clear(),e.forEach(e=>e.abort()),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach((t,r)=>e(r))}get(e){const t=this._deferreds.get(e);return t?t.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(e,t){const r=this.get(e);if(r)return r;const i=new AbortController;let o=null;t&&(o=(0,s.u7)(t,()=>i.abort()));const n=()=>{l.remove(),null!=o&&o.remove(),this._removeItem(e),this._queue.remove(e),this._scheduleNext()},l=(0,s.NY)(i.signal,()=>{const t=this._processingItems.get(e);t&&t.controller.abort(),n(),a.reject((0,s.NK)())}),a=(0,s.Tw)();return this._deferreds.set(e,a),this._controllers.set(e,i),a.promise.then(n,n),this._queue.push(e),this._scheduleNext(),a.promise}last(){return this._queue.last()}lastPromise(){const e=this.last();return e?this.get(e):null}peek(){return this._queue.peek()}popLast(){var e;const t=this._queue.popLast();return t&&(null!==(e=this._deferreds.get(t))&&void 0!==e&&e.reject((0,s.NK)()),this._removeItem(t)),t}reset(){const e=Array.from(this._processingItems.values());this._processingItems.clear();for(const t of e)this._queue.push(t.item),t.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}_removeItem(e){this._deferreds.delete(e),this._controllers.delete(e),this._processingItems.delete(e)}_scheduleNext(){this._pausedSignal.value||this._schedule||(this._schedule=(0,l._)(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,t){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(t))}_processError(e,t){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(t))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(null==e)return;let t;const r=new AbortController,i=new u(e,r);this._processingItems.set(e,i);try{t=this.process(e,r.signal)}catch(o){this._processError(i,o)}(0,s.$X)(t)?(i.promise=t,t.then(e=>this._processResult(i,e),e=>this._processError(i,e))):this._processResult(i,t)}}},36035(e,t,r){r.d(t,{i_:()=>s});var i=r(53430);function s(e,t,r){var s,l;t=null===(s=(0,i.rS)(t))||void 0===s?void 0:s.toLowerCase(),r=null===(l=(0,i.rS)(r))||void 0===l?void 0:l.toLowerCase();const a=e.map(e=>e.toLowerCase()),u=t?e[a.indexOf(t)]:null,d=r?e[a.indexOf(r)]:null;return{longitudeFieldName:u||e[a.indexOf(n.find(e=>a.includes(e)))],latitudeFieldName:d||e[a.indexOf(o.find(e=>a.includes(e)))]}}const o=["lat","lat83","latitude","latitude83","latdecdeg","lat_dd","y","ycenter","point_y"],n=["lon","lng","lng83","long","long83","longitude","longitude83","longdecdeg","long_dd","x","xcenter","point_x"]},62547(e,t,r){r.d(t,{Z:()=>a});var i=r(6326),s=r(69098),o=r(42553),n=r(46053),l=(r(81806),r(76460),r(47249),r(87990));let a=class extends((0,s.OU)(o.o)){constructor(e){super(e),this.type=null}};(0,i.Cg)([(0,n.MZ)({type:["wkb","location"],nonNullable:!0,readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],a.prototype,"type",void 0),a=(0,i.Cg)([(0,l.$)("esri.layers.support.ParquetEncodingBase")],a)},71749(e,t,r){r.r(t),r.d(t,{default:()=>ne});var i=r(6326),s=r(16868),o=r(69098),n=r(19276),l=r(50076),a=r(81806),u=r(77717),d=r(48611),c=r(68134),p=r(46053),y=r(28379),h=r(87990),g=r(17707),m=r(76797),f=r(13312),v=r(74398),_=r(61024),w=r(57274),q=r(9465);const x=Symbol("isParquetGraphicOrigin");var C;class b extends q.A{get[(C=x,_.ym)](){return this.layer}get[v.e](){return this.layer}get[w.Q](){return this.layer}constructor(e){super(),this[C]=!0,this.type="parquet",this.layer=e}get id(){return this.layer.id}}var O=r(25515),F=r(49304),N=r(76460),A=r(50346),M=r(16783),S=r(30178),Z=r(77725);let P=class extends F.x_{constructor(e){super(e),this.type="parquet"}load(e){const t=null!=e?e.signal:null;return this.addResolvingPromise(this._initialize(t)),Promise.resolve(this)}destroy(){var e;null===(e=this._connection)||void 0===e||e.destroy()}setCustomParameters(e){this._proxy.setCustomParameters(e).catch(()=>{N.A.getLogger(this).warn("Failed to update customParameters")})}async updateFiles(e){await this._proxy.updateFiles(e)}async queryFeaturesJSON(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.load(t),this._proxy.queryFeatures(e.toJSON(),{signal:null===t||void 0===t?void 0:t.signal})}async queryFeatures(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=await this.queryFeaturesJSON(e,{signal:null===t||void 0===t?void 0:t.signal});return Z.A.fromJSON(r)}async queryObjectIds(e,t){return await this._proxy.queryObjectIds(e.toJSON(),{signal:null===t||void 0===t?void 0:t.signal})}async queryFeatureCount(e,t){return this._proxy.queryFeatureCount(e.toJSON(),{signal:null===t||void 0===t?void 0:t.signal})}async queryExtent(e,t){if(null==this.layer.encoding)return N.A.getLogger(this).warn("Tried to queryExtent, but source does not have a geometry. Returning null extent."),{count:0,extent:null};const r=await this._proxy.queryExtent(e.toJSON(),{signal:null===t||void 0===t?void 0:t.signal});return{count:r.count,extent:m.A.fromJSON(r.extent)}}async _initialize(e){var t,r,i;this._connection=await(0,M.ho)("ParquetSourceWorker",{strategy:"dedicated",signal:e,registryTarget:this}),(0,A.Te)(e),this._proxy=this._connection.createInvokeProxy();const{layerDefinition:s,capabilities:o}=await this._proxy.load({urls:this.layer.urls.items,fields:null===(t=this.layer.fields)||void 0===t?void 0:t.map(e=>e.toJSON()),geometryType:this.layer.geometryType?(0,S.sA)(this.layer.geometryType):null,spatialReference:null===(r=this.layer.spatialReference)||void 0===r?void 0:r.toJSON(),encoding:null===(i=this.layer.encoding)||void 0===i?void 0:i.toJSON(),displayOptimization:this.layer.displayOptimization,customParameters:this.layer.customParameters});(0,A.Te)(e),this.sourceJSON=s,this.capabilities=o}};(0,i.Cg)([(0,p.MZ)()],P.prototype,"type",void 0),(0,i.Cg)([(0,p.MZ)({constructOnly:!0})],P.prototype,"layer",void 0),(0,i.Cg)([(0,p.MZ)()],P.prototype,"sourceJSON",void 0),(0,i.Cg)([(0,p.MZ)()],P.prototype,"capabilities",void 0),P=(0,i.Cg)([(0,h.$)("esri.layers.graphics.sources.ParquetSource")],P);var I=r(65624),j=r(31362),k=r(30218),R=r(74440),T=r(37207),z=r(11270),E=r(37534),J=r(5682),L=r(78817),D=r(95363),G=r(15427),Q=r(44135),U=r(76350),$=r(53430),V=r(95114),B=r(27937),K=r(62547),W=r(98141),H=r(19208),X=r(34373),Y=r(68295),ee=r(79453),te=r(30973);const re=(0,U.p)(),ie="__OBJECTID",se={types:{key:"type",base:K.Z,typeMap:{wkb:H.A,location:W.A}},json:{name:"layerDefinition.geometryEncoding",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{read:{source:"geometryEncoding"}}}}};let oe=class extends((0,k.FJ)((0,T.J)((0,R.F)((0,I.dM)((0,E.fY)((0,L.e)((0,J.j)((0,z.q)((0,u.P)((0,j.d)((0,o.OU)(O.A)))))))))))){constructor(e){super(e),this.copyright=null,this.displayOptimization=null,this.fields=null,this.fieldsIndex=null,this.encoding=null,this.fullExtent=null,this.geometryType=null,this.graphicOrigin=new b(this),this.labelsVisible=!0,this.labelingInfo=null,this.objectIdField=ie,this.operationalLayerType="ParquetLayer",this.outFields=null,this.persistenceEnabled=!!(0,a.A)("parquetlayer-persistence-enabled"),this.popupTemplate=null,this.source=null,this.spatialReference=null,this.templates=null,this.title="Parquet",this.type="parquet",this.urls=new n.A}destroy(){var e;null===(e=this.source)||void 0===e||e.destroy()}async load(e){return this.addResolvingPromise(this._load(e)),this.addHandles([(0,c.wB)(()=>this.urls,e=>{var t;return null===(t=this.source)||void 0===t?void 0:t.updateFiles(e.items)}),(0,c.wB)(()=>this.customParameters,e=>{var t;return null===(t=this.source)||void 0===t?void 0:t.setCustomParameters(e)})]),this}get capabilities(){var e;return null===(e=this.source)||void 0===e?void 0:e.capabilities}get defaultPopupTemplate(){return this.createPopupTemplate()}writeFields(e,t,r,i){const s=e.filter(e=>!(e.name===ie&&"oid"===e.type)).map(e=>e.toJSON(i));(0,d.sM)(r,s,t)}get isTable(){return null==this.encoding}set renderer(e){(0,$.yp)(e,this.fieldsIndex),this._set("renderer",e)}readUrls(e){return new n.A("files"===e.type?e.urls:[])}writeUrls(e,t,r,i){var s;const o=[];if(null!==e&&void 0!==e&&e.length){var n;i={blockedRelativeUrls:null===(n=i)||void 0===n?void 0:n.blockedRelativeUrls};for(let t of e)t=(0,ee.t)(t,i),t&&o.push(t)}o.length?t.source={type:"files",urls:o}:null===(s=i.messages)||void 0===s||s.push(new l.A("parquet-layer:missing-urls","Missing or empty 'urls'",{layer:this}))}createPopupTemplate(e){return(0,te.tn)(this,e)}createQuery(){const e=new Y.A;return e.returnGeometry=!0,e.outFields=["*"],e}async createSource(e){const t=new P({layer:this});return await t.load(e),t}getFieldDomain(e,t){return null}getField(e){return this.fieldsIndex.get(e)}async queryFeatures(e,t){await this.load();const r=await this.source.queryFeatures(this._normalizeQuery(e),t),i=this.graphicOrigin;if(null!==r&&void 0!==r&&r.features)for(const s of r.features)s.layer=s.sourceLayer=this,s.origin=i;return r}async queryObjectIds(e,t){return await this.load(),this.source.queryObjectIds(this._normalizeQuery(e),t)}async queryFeatureCount(e,t){return await this.load(),this.source.queryFeatureCount(this._normalizeQuery(e),t)}async queryExtent(e,t){return await this.load(),this.source.queryExtent(this._normalizeQuery(e),t)}_normalizeQuery(e){var t;return null!==(t=Y.A.from(e))&&void 0!==t?t:this.createQuery()}async _load(e){const t=await this.createSource(e);this._set("source",t),this.read(t.sourceJSON,{origin:"service"}),this.revert(["fields","timeInfo"],"service"),(0,$.yp)(this.renderer,this.fieldsIndex),(0,$.sv)(this.timeInfo,this.fieldsIndex),null==this.spatialReference&&(this.spatialReference=f.A.WGS84)}};(0,i.Cg)([(0,p.MZ)({readOnly:!0,json:{read:!1,write:!1}})],oe.prototype,"capabilities",null),(0,i.Cg)([(0,p.MZ)({type:String})],oe.prototype,"copyright",void 0),(0,i.Cg)([(0,p.MZ)({readOnly:!0})],oe.prototype,"defaultPopupTemplate",null),(0,i.Cg)([(0,p.MZ)()],oe.prototype,"displayOptimization",void 0),(0,i.Cg)([(0,p.MZ)({type:[Q.A],json:{name:"layerDefinition.fields",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"fields"}}}})],oe.prototype,"fields",void 0),(0,i.Cg)([(0,g.K)("fields")],oe.prototype,"writeFields",null),(0,i.Cg)([(0,p.MZ)(re.fieldsIndex)],oe.prototype,"fieldsIndex",void 0),(0,i.Cg)([(0,p.MZ)(se)],oe.prototype,"encoding",void 0),(0,i.Cg)([(0,p.MZ)({type:m.A,json:{name:"extent"}})],oe.prototype,"fullExtent",void 0),(0,i.Cg)([(0,p.MZ)({type:S.ye.apiValues,json:{name:"layerDefinition.geometryType",read:{reader:S.ye.read},write:{writer:S.ye.write,ignoreOrigin:!0,isRequired:!0},origins:{service:{read:{source:"geometryType",reader:S.ye.read}}}}})],oe.prototype,"geometryType",void 0),(0,i.Cg)([(0,p.MZ)({readOnly:!0,clonable:!1})],oe.prototype,"graphicOrigin",void 0),(0,i.Cg)([(0,p.MZ)(D.kF)],oe.prototype,"labelsVisible",void 0),(0,i.Cg)([(0,p.MZ)({type:[V.A],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:B.w},write:!0}})],oe.prototype,"labelingInfo",void 0),(0,i.Cg)([(0,p.MZ)(D.fV)],oe.prototype,"legendEnabled",void 0),(0,i.Cg)([(0,p.MZ)()],oe.prototype,"file",void 0),(0,i.Cg)([(0,p.MZ)({type:String,readOnly:!0})],oe.prototype,"objectIdField",void 0),(0,i.Cg)([(0,p.MZ)({type:["ParquetLayer"]})],oe.prototype,"operationalLayerType",void 0),(0,i.Cg)([(0,p.MZ)(re.outFields)],oe.prototype,"outFields",void 0),(0,i.Cg)([(0,p.MZ)(D.M6)],oe.prototype,"popupEnabled",void 0),(0,i.Cg)([(0,p.MZ)({type:s.A,json:{name:"popupInfo",write:!0}})],oe.prototype,"popupTemplate",void 0),(0,i.Cg)([(0,p.MZ)({types:X.Hg,json:{name:"layerDefinition.drawingInfo.renderer",write:!0,origins:{service:{read:{source:"drawingInfo.renderer"}}}}})],oe.prototype,"renderer",null),(0,i.Cg)([(0,p.MZ)({type:P,readOnly:!0,cast:null,json:{read:!1}})],oe.prototype,"source",void 0),(0,i.Cg)([(0,p.MZ)({json:{name:"layerDefinition.spatialReference",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{read:{source:"extent.spatialReference"}}}}})],oe.prototype,"spatialReference",void 0),(0,i.Cg)([(0,p.MZ)({type:[G.A]})],oe.prototype,"templates",void 0),(0,i.Cg)([(0,p.MZ)()],oe.prototype,"title",void 0),(0,i.Cg)([(0,p.MZ)({json:{read:!1},readOnly:!0})],oe.prototype,"type",void 0),(0,i.Cg)([(0,p.MZ)({type:n.A.ofType(String),json:{name:"source",write:{isRequired:!0,ignoreOrigin:!0}}})],oe.prototype,"urls",void 0),(0,i.Cg)([(0,y.w)("urls")],oe.prototype,"readUrls",null),(0,i.Cg)([(0,g.K)("urls")],oe.prototype,"writeUrls",null),oe=(0,i.Cg)([(0,h.$)("esri.layers.ParquetLayer")],oe);const ne=oe},98141(e,t,r){r.d(t,{A:()=>l});var i=r(6326),s=r(46053),o=(r(81806),r(76460),r(47249),r(87990)),n=r(62547);let l=class extends n.Z{constructor(e){super(e),this.type="location",this.latitudeFieldName=null,this.longitudeFieldName=null}};(0,i.Cg)([(0,s.MZ)({type:["location"]})],l.prototype,"type",void 0),(0,i.Cg)([(0,s.MZ)({type:String,json:{name:"yField",write:{isRequired:!0}}})],l.prototype,"latitudeFieldName",void 0),(0,i.Cg)([(0,s.MZ)({type:String,json:{name:"xField",write:{isRequired:!0}}})],l.prototype,"longitudeFieldName",void 0),l=(0,i.Cg)([(0,o.$)("esri.layers.support.ParquetEncodingLocation")],l)}}]);
//# sourceMappingURL=2649.d89d3b21.chunk.js.map